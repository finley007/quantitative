股票数据

描述：
1. 3s采样一次
2. 以天为单位
文件数量 find ./ -type f | wc -l  4758
文件大小总和 du -hs  7.2g
一年 365*5/7

schema:
代码          tscode
交易所代码     exchange_tscode
自然日        date
时间          time
成交价        price
成交量        volume
成交额        amount
成交笔数      transaction_number
IOPV(先忽略)  iopv
成交标志      transaction_flag
BS标志        bs_flag 
当日累计成交量  daily_accumulated_volume
当日成交额     daily_amount
最高价        high
最低价        low
开盘价        open
前收盘        close
申卖价1       bid_price1
申卖价2       bid_price2
申卖价3       bid_price3
申卖价4       bid_price4
申卖价5       bid_price5
申卖价6       bid_price6
申卖价7       bid_price7
申卖价8       bid_price8
申卖价9       bid_price9
申卖价10      bid_price10
申卖量1       bid_volume1
申卖量2       bid_volume2
申卖量3       bid_volume3
申卖量4       bid_volume4
申卖量5       bid_volume5
申卖量6       bid_volume6
申卖量7       bid_volume7
申卖量8       bid_volume8
申卖量9       bid_volume9
申卖量10      bid_volume10
申买价1       ask_price1
申买价2       ask_price2
申买价3       ask_price3
申买价4       ask_price4
申买价5       ask_price5
申买价6       ask_price6
申买价7       ask_price7
申买价8       ask_price8
申买价9       ask_price9
申买价10      ask_price10
申买量1       ask_volume1
申买量2       ask_volume2
申买量3       ask_volume3
申买量4       ask_volume4
申买量5       ask_volume5
申买量6       ask_volume6
申买量7       ask_volume7
申买量8       ask_volume8
申买量9       ask_volume9
申买量10      ask_volume10
加权平均叫卖价 weighted_average_bid_price
加权平均叫买价 weighted_average_ask_price
叫卖总量      total_bid_volume
叫买总量      total_ask_volume
不加权指数    unwighted_index
品种总数(先忽略)      total_varieties
上涨品种数(先忽略)    total_increase_varieties
下跌品种数(先忽略)    total_falling_varieties
持平品种数(先忽略)    total_equal_varieties

数据验证：
采样间隔：3s 数据总量：(2 + 2) * 60 * 60 / 3 = 4800 有数据缺失的需要检查:sh600449_20170103.csv
起始时间：09：25
结束时间：15：00
1. 数据完整性验证：单纯验证数量和4800比较（全量验证）
2. 数据重复性和缺失检查（随机验证）
3. 成交量递增验证：按时间排序获取一个list，按成交量排序再取一个list，做签名比较（全量验证）
验证报告：
整体报告：检查记录总数，成功数，失败数
详细报告：

数据处理：
1. 列名翻译 StockTickDataColumnTransform
2. 数据清洗: 去掉多余的列 去掉09:15之前的数据 StockTickDataCleaner
    处理volume倒序：
    原因一：000028.SZ               28  2017-01-05         0::.0    0.0       0 
    原因二：
    "      exchange_tscode        date          time  price  volume  \
1188           600025  2022-03-18  10:26:35.000   5.87   17700   
1189           600025  2022-03-18  10:26:38.000   5.87       0   
1190           600025  2022-03-18  10:26:38.000   5.87    1000   

      daily_accumulated_volume  
1188                   9139550  
1189                   9139550  
1190                   9140550"
    处理不在3秒对齐位置的无效的数据：向后一个位置对齐，如果后一个位置数据已存在则丢弃当前数据
	代码	交易所代码	自然日	时间	成交价	成交量	成交额	成交笔数	IOPV	成交标志	BS标志	当日累计成交量	当日成交额	最高价	最低价	开盘价	前收盘	申卖价1	申卖价2	申卖价3	申卖价4	申卖价5	申卖价6	申卖价7	申卖价8	申卖价9	申卖价10	申卖量1	申卖量2	申卖量3	申卖量4	申卖量5	申卖量6	申卖量7	申卖量8	申卖量9	申卖量10	申买价1	申买价2	申买价3	申买价4	申买价5	申买价6	申买价7	申买价8	申买价9	申买价10	申买量1	申买量2	申买量3	申买量4	申买量5	申买量6	申买量7	申买量8	申买量9	申买量10	加权平均叫卖价	加权平均叫买价	叫卖总量	叫买总量	不加权指数	品种总数	上涨品种数	下跌品种数	持平品种数
119	688188.SH	688188	2022/4/29	33:36.0	234.12	0	0	154	0			30378	7082771	236.7	230.99	230.99	238.7	234.12	234.29	234.3	234.36	234.9	234.99	235.49	236.55	236.69	237.98	144	200	200	400	300	300	200	366	200	200	233.6	233.05	233.02	233.01	233	232.37	232.27	232.2	232.01	231.56	200	200	200	200	1002	1000	300	1083	400	415	0	0	20433	23675	0	0	0	0	0
120	688188.SH	688188	2022/4/29	33:38.0	234.12	0	0	154	0			30378	7082771	236.7	230.99	230.99	238.7	234.12	234.3	234.36	234.9	234.99	235.49	236.55	236.69	237.98	237.99	144	200	400	300	300	200	366	200	200	200	233.6	233.05	233.02	233.01	233	232.37	232.27	232.2	232.01	231.56	200	200	200	400	1002	1000	300	1083	400	415	0	0	20233	23875	0	0	0	0	0
121	688188.SH	688188	2022/4/29	33:41.0	234.12	0	0	154	0			30378	7082771	236.7	230.99	230.99	238.7	234.12	234.3	234.36	234.9	234.99	235.49	236.55	236.69	237.98	237.99	144	200	400	300	300	200	366	200	200	200	233.6	233.01	233	232.37	232.27	232.2	232.01	231.56	231.55	231.54	200	400	1002	1000	300	1083	400	415	404	1300	0	0	17929	23475	0	0	0	0	0
122	688188.SH	688188	2022/4/29	33:44.0	234.12	200	46824	156	0			30578	7129595	236.7	230.99	230.99	238.7	234.12	234.3	234.36	234.9	234.99	235.49	236.55	236.69	237.98	237.99	565	200	400	300	300	200	366	200	200	200	233.6	233.01	233	232.37	232.27	232.2	232.01	231.56	231.55	231.54	200	400	1002	1000	300	1083	400	415	404	1300	0	0	18350	23475	0	0	0	0	0
123	688188.SH	688188	2022/4/29	33:47.0	234.12	400	93648	158	0			30978	7223243	236.7	230.99	230.99	238.7	234.12	234.3	234.36	234.9	234.99	235.49	236.55	236.69	237.98	237.99	921	200	400	300	300	200	366	200	200	200	233.6	233.01	233	232.37	232.27	232.2	232.01	231.56	231.55	231.54	400	400	1002	1000	300	589	200	415	404	1300	0	0	18706	22981	0	0	0	0	0
124	688188.SH	688188	2022/4/29	33:50.0	234.12	201	47054	160	0			31179	7270297	236.7	230.99	230.99	238.7	234.12	234.3	234.36	234.9	234.99	235.49	236.55	236.69	237.98	237.99	920	200	400	300	300	200	366	200	200	200	233.6	233.01	233	232.37	232.27	232.2	232.01	231.56	231.55	231.54	400	500	1002	1000	300	339	200	415	404	1300	0	0	18705	22831	0	0	0	0	0
125	688188.SH	688188	2022/4/29	33:54.0	234.12	0	0	160	0			31179	7270297	236.7	230.99	230.99	238.7	234.12	234.3	234.36	234.9	234.99	235.49	236.55	236.69	237.98	237.99	920	200	400	300	300	200	366	200	200	200	234.1	233.6	233.01	233	232.37	232.27	232.01	231.56	231.55	231.54	200	200	700	1002	1000	300	200	415	404	1300	0	0	19005	22692	0	0	0	0	0

	代码	交易所代码	自然日	时间	成交价	成交量	成交额	成交笔数	IOPV	成交标志	BS标志	当日累计成交量	当日成交额	最高价	最低价	开盘价	前收盘	申卖价1	申卖价2	申卖价3	申卖价4	申卖价5	申卖价6	申卖价7	申卖价8	申卖价9	申卖价10	申卖量1	申卖量2	申卖量3	申卖量4	申卖量5	申卖量6	申卖量7	申卖量8	申卖量9	申卖量10	申买价1	申买价2	申买价3	申买价4	申买价5	申买价6	申买价7	申买价8	申买价9	申买价10	申买量1	申买量2	申买量3	申买量4	申买量5	申买量6	申买量7	申买量8	申买量9	申买量10	加权平均叫卖价	加权平均叫买价	叫卖总量	叫买总量	不加权指数	品种总数	上涨品种数	下跌品种数	持平品种数
164	688188.SH	688188	2022/4/29	35:48.0	234.01	0	0	194	0			37212	8683604	236.7	230.99	230.99	238.7	234.38	234.39	234.4	234.45	234.48	234.61	235.06	235.76	236.01	236.15	200	200	400	200	200	200	200	200	500	800	233.82	233.53	233.52	233.19	233.18	233.01	233	232.7	232.01	231.56	200	200	200	945	600	500	3836	700	200	415	0	0	23289	25201	0	0	0	0	0
165	688188.SH	688188	2022/4/29	35:52.0	234.01	0	0	194	0			37212	8683604	236.7	230.99	230.99	238.7	234.38	234.39	234.4	234.45	234.48	234.61	235.06	235.76	236	236.01	200	200	400	200	200	200	200	200	200	500	233.82	233.53	233.52	233.19	233.18	233.01	233	232.7	232.01	231.56	200	200	200	945	600	500	3836	700	200	415	0	0	23489	25201	0	0	0	0	0
166	688188.SH	688188	2022/4/29	35:55.0	234.01	0	0	194	0			37212	8683604	236.7	230.99	230.99	238.7	234.37	234.38	234.39	234.45	234.48	234.61	235.06	235.76	236	236.01	800	200	200	200	200	200	200	200	200	500	233.82	233.53	233.52	233.19	233.18	233.01	233	232.7	232.01	231.56	200	200	200	945	600	500	3836	700	200	415	0	0	23889	25201	0	0	0	0	0
167	688188.SH	688188	2022/4/29	35:58.0	234.01	0	0	194	0			37212	8683604	236.7	230.99	230.99	238.7	234.37	234.38	234.39	234.45	234.48	234.61	235.06	235.76	236	236.01	1000	200	200	200	200	200	200	200	200	500	233.84	233.82	233.55	233.53	233.52	233.19	233.18	233.01	233	232.7	495	200	383	200	200	945	600	500	3836	700	0	0	24089	26079	0	0	0	0	0
168	688188.SH	688188	2022/4/29	36:01.0	234.01	0	0	194	0			37212	8683604	236.7	230.99	230.99	238.7	234.36	234.37	234.39	234.45	234.48	234.61	235.06	235.76	236	236.01	200	1000	200	200	200	200	200	200	200	500	233.84	233.82	233.55	233.53	233.52	233.19	233.18	233.01	233	232.7	495	200	383	200	200	945	600	500	3836	700	0	0	24089	26079	0	0	0	0	0
169	688188.SH	688188	2022/4/29	36:04.0	234.01	0	0	194	0			37212	8683604	236.7	230.99	230.99	238.7	234.35	234.36	234.39	234.45	234.48	234.61	235.06	235.76	236	236.01	1000	200	200	200	200	200	200	200	200	500	233.84	233.82	233.55	233.53	233.52	233.19	233.18	233.01	233	232.7	495	200	383	200	200	945	600	500	3836	700	0	0	24089	26279	0	0	0	0	0
170	688188.SH	688188	2022/4/29	36:07.0	234	200	46800	195	0			37412	8730404	236.7	230.99	230.99	238.7	234.33	234.34	234.35	234.39	234.48	234.61	235.06	235.76	236	236.01	200	400	800	200	200	200	200	200	200	500	233.84	233.82	233.55	233.53	233.52	233.19	233.18	233.01	233	232.7	495	200	383	200	200	945	600	500	3836	700	0	0	24089	26279	0	0	0	0	0
171	688188.SH	688188	2022/4/29	36:10.0	233.84	272	63605	196	0			37684	8794009	236.7	230.99	230.99	238.7	234.31	234.32	234.34	234.48	234.61	235.06	235.76	236	236.01	236.15	200	1000	200	200	200	200	200	200	500	800	233.84	233.55	233.52	233.19	233.18	233.01	233	232.7	232.01	231.56	223	383	200	945	600	500	3836	700	200	415	0	0	23889	25607	0	0	0	0	0
172	688188.SH	688188	2022/4/29	36:13.0	233.84	200	46768	197	0			37884	8840777	236.7	230.99	230.99	238.7	234	234.3	234.31	234.32	234.34	234.48	234.61	235.06	235.76	236	300	200	200	1000	200	200	200	200	200	200	233.84	233.55	233.52	233.19	233.18	233.01	233	232.7	232.01	231.56	23	383	200	745	600	500	3836	700	200	415	0	0	24389	25207	0	0	0	0	0
173	688188.SH	688188	2022/4/29	36:16.0	233.84	423	98914	200	0			38307	8939691	236.7	230.99	230.99	238.7	233.84	234	234.3	234.31	234.32	234.34	234.48	234.61	235.06	235.76	1339	300	200	200	1000	200	200	200	200	200	233.55	233.52	233.19	233.18	233.01	233	232.7	232.01	231.56	231.55	383	200	745	600	500	3836	700	200	415	404	0	0	27940	25184	0	0	0	0	0
174	688188.SH	688188	2022/4/29	36:21.0	233.55	200	46710	201	0			38507	8986401	236.7	230.99	230.99	238.7	233.83	233.84	234	234.3	234.31	234.32	234.34	234.48	234.61	235.06	200	1339	300	200	200	1000	200	200	200	200	233.55	233.52	233.18	233.01	233	232.7	232.01	231.56	231.55	231.54	183	200	600	500	3836	700	200	415	404	900	0	0	28140	24239	0	0	0	0	0

3. 数据插值

算法：
数据过滤：
根据期指成分股过滤股票数据，以减小数据集。
1. 将期指成分股转换成startdate-enddate:stocklist的映射。
2. 给定year和month，遍历每个date下的股票文件，查询startdate-enddate:stocklist映射，在列表里保留并压缩不在则删除
测定执行时间和压缩比
过滤前大小：68g
过滤前文件数量:
过滤后大小：118m
过滤后文件数量: 801?应该是850
证50和沪深300交集
['600000', '600016', '600028', '600029', '600030', '600036', '600048', '600050', '600100', '600104', '600111', '600340', '600485', '600518', '600519', '600547', '600606', '600837', '600887', '600958', '600999', '601006', '601088', '601166', '601169', '601186', '601198', '601211', '601288', '601318', '601328', '601336', '601390', '601398', '601601', '601628', '601668', '601688', '601766', '601788', '601800', '601818', '601857', '601901', '601985', '601988', '601989']
47
沪深300和上证500交集
['600549']
1

数据对齐：
从9：30开始，遍历每一个tick数据检查秒能不能被3整除，如果可以不做处理，如果不可以，检查下一个被3整除的时间点有没有数据，如果有丢弃当前数据，如果没有则更新当前时间秒到下一个被3整除的时间点

问题：
1. organised数据格式？
2. 股票数据缺失 sh603868_20170111.csv
2897
# data['hour']=data['time'].str[0:2]
# data['min']=data['time'].str[3:5]
# print(data.groupby('hour')['time'].count())
# print(data[(data['hour'] == '09') & (data['min'] == '31')])
hour
08      1
09    474
10    798
11    361
12      2
13    576
14    682
15      3
解决办法：插值
3. volume倒序，因为有这样的数据：
000028.SZ               28  2017-01-05         0::.0    0.0       0 
4. 数据缺失：
2017.03.07
2017.05.22
2017.05.31
2017.12.01
2017.06.07 600373
2017.05.08 002833
2019.05.08
2019.05.20 600009
2019.07.22-2019.07.30
2019.12.31





