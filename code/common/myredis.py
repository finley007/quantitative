#! /usr/bin/env python
# -*- coding:utf8 -*-

import redis
import pandas as pd
import _pickle as cPickle

from data.access import StockDataAccess, StockDailyDataAccess, BatchStockDataAccess
from common.aop import timing

class RedisClient():

    def __init__(self, ip = '127.0.0.1', port = 6379):
        self._ip = ip
        self._port = port
        self._redis_client = redis.Redis(host=self._ip, port=self._port, db=0)

    @classmethod
    def get_ins(cls):
        return RedisClient()

    @timing
    def save(self, key, data):
        self._redis_client.set(key, cPickle.dumps(data))

    @timing
    def load(self, key):
        return cPickle.loads(self._redis_client.get(key))

    @timing
    def delete(self, key):
        self._redis_client.delete(key)


if __name__ == '__main__':
    client = RedisClient()
    # client.save('test', 'test')
    # print(client.load('test'))
    # client.delete('test')

    # data_access = StockDataAccess(check_original = False)
    # data = data_access.access('20170502', '000002')
    # print(data.__sizeof__())
    # client.save('data', data)
    # new_data = client.load('data')
    # print(new_data.__sizeof__())
    #
    stock_file_list = [('2017-04-24', '000627'), ('2017-04-24', '000681'), ('2017-04-24', '002602'), ('2017-04-24', '600392'), ('2017-04-24', '000919'), ('2017-04-24', '601888'), ('2017-04-24', '000777'), ('2017-04-24', '600180'), ('2017-04-24', '601001'), ('2017-04-24', '002179'), ('2017-04-24', '000069'), ('2017-04-24', '601318'), ('2017-04-24', '002004'), ('2017-04-24', '600271'), ('2017-04-24', '600291'), ('2017-04-24', '603528'), ('2017-04-24', '601958'), ('2017-04-24', '300147'), ('2017-04-24', '002353'), ('2017-04-24', '600338'), ('2017-04-24', '600260'), ('2017-04-24', '600499'), ('2017-04-24', '300032'), ('2017-04-24', '600397'), ('2017-04-24', '000417'), ('2017-04-24', '600958'), ('2017-04-24', '600525'), ('2017-04-24', '600862'), ('2017-04-24', '000963'), ('2017-04-24', '600808'), ('2017-04-24', '002233'), ('2017-04-24', '600395'), ('2017-04-24', '000333'), ('2017-04-24', '000826'), ('2017-04-24', '600754'), ('2017-04-24', '000426'), ('2017-04-24', '600169'), ('2017-04-24', '600545'), ('2017-04-24', '600458'), ('2017-04-24', '600720'), ('2017-04-24', '002315'), ('2017-04-24', '600060'), ('2017-04-24', '000961'), ('2017-04-24', '601908'), ('2017-04-24', '000519'), ('2017-04-24', '000960'), ('2017-04-24', '600651'), ('2017-04-24', '300072'), ('2017-04-24', '002345'), ('2017-04-24', '600688'), ('2017-04-24', '002797'), ('2017-04-24', '600549'), ('2017-04-24', '000876'), ('2017-04-24', '000712'), ('2017-04-24', '600383'), ('2017-04-24', '002373'), ('2017-04-24', '002131'), ('2017-04-24', '600064'), ('2017-04-24', '600316'), ('2017-04-24', '000830'), ('2017-04-24', '002665'), ('2017-04-24', '300156'), ('2017-04-24', '300113'), ('2017-04-24', '600039'), ('2017-04-24', '002482'), ('2017-04-24', '002681'), ('2017-04-24', '600340'), ('2017-04-24', '002456'), ('2017-04-24', '600600'), ('2017-04-24', '600705'), ('2017-04-24', '600825'), ('2017-04-24', '000738'), ('2017-04-24', '601155'), ('2017-04-24', '601669'), ('2017-04-24', '000009'), ('2017-04-24', '300199'), ('2017-04-24', '002001'), ('2017-04-24', '601877'), ('2017-04-24', '002368'), ('2017-04-24', '000878'), ('2017-04-24', '600266'), ('2017-04-24', '601989'), ('2017-04-24', '600809'), ('2017-04-24', '002292'), ('2017-04-24', '600256'), ('2017-04-24', '002242'), ('2017-04-24', '002508'), ('2017-04-24', '000917'), ('2017-04-24', '300001'), ('2017-04-24', '000810'), ('2017-04-24', '601998'), ('2017-04-24', '002063'), ('2017-04-24', '600611'), ('2017-04-24', '000969'), ('2017-04-24', '600028'), ('2017-04-24', '000970'), ('2017-04-24', '002428'), ('2017-04-24', '000816'), ('2017-04-24', '002375'), ('2017-04-24', '600851'), ('2017-04-24', '600575'), ('2017-04-24', '601699'), ('2017-04-24', '002223'), ('2017-04-24', '002073'), ('2017-04-24', '000541'), ('2017-04-24', '600292'), ('2017-04-24', '000488'), ('2017-04-24', '002236'), ('2017-04-24', '600187'), ('2017-04-24', '600252'), ('2017-04-24', '601628'), ('2017-04-24', '000858'), ('2017-04-24', '002450'), ('2017-04-24', '600837'), ('2017-04-24', '600418'), ('2017-04-24', '601718'), ('2017-04-24', '600522'), ('2017-04-24', '002392'), ('2017-04-24', '000703'), ('2017-04-24', '300033'), ('2017-04-24', '600497'), ('2017-04-24', '002078'), ('2017-04-24', '002701'), ('2017-04-24', '002512'), ('2017-04-24', '000727'), ('2017-04-24', '600036'), ('2017-04-24', '002463'), ('2017-04-24', '000060'), ('2017-04-24', '603555'), ('2017-04-24', '000793'), ('2017-04-24', '300055'), ('2017-04-24', '600362'), ('2017-04-24', '600085'), ('2017-04-24', '600801'), ('2017-04-24', '600270'), ('2017-04-24', '601311'), ('2017-04-24', '300297'), ('2017-04-24', '600221'), ('2017-04-24', '600536'), ('2017-04-24', '002024'), ('2017-04-24', '000559'), ('2017-04-24', '002285'), ('2017-04-24', '600717'), ('2017-04-24', '600053'), ('2017-04-24', '600873'), ('2017-04-24', '600015'), ('2017-04-24', '000778'), ('2017-04-24', '002276'), ('2017-04-24', '000652'), ('2017-04-24', '002249'), ('2017-04-24', '600056'), ('2017-04-24', '002118'), ('2017-04-24', '002028'), ('2017-04-24', '002736'), ('2017-04-24', '600410'), ('2017-04-24', '002670'), ('2017-04-24', '600770'), ('2017-04-24', '600894'), ('2017-04-24', '601010'), ('2017-04-24', '000997'), ('2017-04-24', '000418'), ('2017-04-24', '601233'), ('2017-04-24', '603077'), ('2017-04-24', '002269'), ('2017-04-24', '600170'), ('2017-04-24', '000021'), ('2017-04-24', '600109'), ('2017-04-24', '600628'), ('2017-04-24', '002437'), ('2017-04-24', '600787'), ('2017-04-24', '603001'), ('2017-04-24', '002384'), ('2017-04-24', '000786'), ('2017-04-24', '002191'), ('2017-04-24', '600729'), ('2017-04-24', '603369'), ('2017-04-24', '000025'), ('2017-04-24', '600108'), ('2017-04-24', '000517'), ('2017-04-24', '000726'), ('2017-04-24', '600059'), ('2017-04-24', '000839'), ('2017-04-24', '300257'), ('2017-04-24', '600240'), ('2017-04-24', '601216'), ('2017-04-24', '000690'), ('2017-04-24', '000800'), ('2017-04-24', '600195'), ('2017-04-24', '600251'), ('2017-04-24', '600823'), ('2017-04-24', '002470'), ('2017-04-24', '600176'), ('2017-04-24', '000501'), ('2017-04-24', '600006'), ('2017-04-24', '601618'), ('2017-04-24', '002581'), ('2017-04-24', '002030'), ('2017-04-24', '000725'), ('2017-04-24', '600409'), ('2017-04-24', '603377'), ('2017-04-24', '002074'), ('2017-04-24', '000758'), ('2017-04-24', '000555'), ('2017-04-24', '600369'), ('2017-04-24', '002281'), ('2017-04-24', '002221'), ('2017-04-24', '000975'), ('2017-04-24', '603000'), ('2017-04-24', '603355'), ('2017-04-24', '002317'), ('2017-04-24', '601390'), ('2017-04-24', '600115'), ('2017-04-24', '600795'), ('2017-04-24', '000869'), ('2017-04-24', '601398'), ('2017-04-24', '600875'), ('2017-04-24', '600312'), ('2017-04-24', '000543'), ('2017-04-24', '002354'), ('2017-04-24', '600519'), ('2017-04-24', '000860'), ('2017-04-24', '600335'), ('2017-04-24', '600489'), ('2017-04-24', '600869'), ('2017-04-24', '000620'), ('2017-04-24', '000977'), ('2017-04-24', '300026'), ('2017-04-24', '600017'), ('2017-04-24', '600649'), ('2017-04-24', '601607'), ('2017-04-24', '002479'), ('2017-04-24', '002503'), ('2017-04-24', '300070'), ('2017-04-24', '000049'), ('2017-04-24', '600023'), ('2017-04-24', '601800'), ('2017-04-24', '601933'), ('2017-04-24', '600425'), ('2017-04-24', '000671'), ('2017-04-24', '000939'), ('2017-04-24', '601555'), ('2017-04-24', '600757'), ('2017-04-24', '603589'), ('2017-04-24', '002065'), ('2017-04-24', '002431'), ('2017-04-24', '000031'), ('2017-04-24', '601012'), ('2017-04-24', '002500'), ('2017-04-24', '002594'), ('2017-04-24', '300182'), ('2017-04-24', '000792'), ('2017-04-24', '000592'), ('2017-04-24', '000776'), ('2017-04-24', '600839'), ('2017-04-24', '601016'), ('2017-04-24', '601880'), ('2017-04-24', '002396'), ('2017-04-24', '600074'), ('2017-04-24', '601009'), ('2017-04-24', '601929'), ('2017-04-24', '002325'), ('2017-04-24', '600048'), ('2017-04-24', '600150'), ('2017-04-24', '600606'), ('2017-04-24', '601988'), ('2017-04-24', '600528'), ('2017-04-24', '000959'), ('2017-04-24', '600068'), ('2017-04-24', '600563'), ('2017-04-24', '600067'), ('2017-04-24', '000563'), ('2017-04-24', '002304'), ('2017-04-24', '600008'), ('2017-04-24', '600751'), ('2017-04-24', '002371'), ('2017-04-24', '002422'), ('2017-04-24', '002440'), ('2017-04-24', '300166'), ('2017-04-24', '600498'), ('2017-04-24', '600971'), ('2017-04-24', '601886'), ('2017-04-24', '002646'), ('2017-04-24', '601000'), ('2017-04-24', '000988'), ('2017-04-24', '601600'), ('2017-04-24', '000090'), ('2017-04-24', '002217'), ('2017-04-24', '603568'), ('2017-04-24', '600999'), ('2017-04-24', '600586'), ('2017-04-24', '300287'), ('2017-04-24', '600633'), ('2017-04-24', '002309'), ('2017-04-24', '600200'), ('2017-04-24', '600618'), ('2017-04-24', '600674'), ('2017-04-24', '600682'), ('2017-04-24', '600188'), ('2017-04-24', '600587'), ('2017-04-24', '002663'), ('2017-04-24', '600126'), ('2017-04-24', '002018'), ('2017-04-24', '000002'), ('2017-04-24', '600233'), ('2017-04-24', '600141'), ('2017-04-24', '002344'), ('2017-04-24', '002466'), ('2017-04-24', '600739'), ('2017-04-24', '002273'), ('2017-04-24', '002489'), ('2017-04-24', '002085'), ('2017-04-24', '300244'), ('2017-04-24', '002153'), ('2017-04-24', '000568'), ('2017-04-24', '600086'), ('2017-04-24', '600820'), ('2017-04-24', '600694'), ('2017-04-24', '000039'), ('2017-04-24', '000768'), ('2017-04-24', '000027'), ('2017-04-24', '000861'), ('2017-04-24', '002399'), ('2017-04-24', '300136'), ('2017-04-24', '300324'), ('2017-04-24', '002048'), ('2017-04-24', '002161'), ('2017-04-24', '601018'), ('2017-04-24', '600446'), ('2017-04-24', '600583'), ('2017-04-24', '601328'), ('2017-04-24', '000598'), ('2017-04-24', '600664'), ('2017-04-24', '300017'), ('2017-04-24', '600315'), ('2017-04-24', '600166'), ('2017-04-24', '603198'), ('2017-04-24', '002254'), ('2017-04-24', '601231'), ('2017-04-24', '603806'), ('2017-04-24', '000006'), ('2017-04-24', '002011'), ('2017-04-24', '002595'), ('2017-04-24', '002271'), ('2017-04-24', '600660'), ('2017-04-24', '300010'), ('2017-04-24', '600503'), ('2017-04-24', '600019'), ('2017-04-24', '600016'), ('2017-04-24', '601211'), ('2017-04-24', '300043'), ('2017-04-24', '002013'), ('2017-04-24', '600000'), ('2017-04-24', '603766'), ('2017-04-24', '002727'), ('2017-04-24', '000547'), ('2017-04-24', '001696'), ('2017-04-24', '600535'), ('2017-04-24', '600759'), ('2017-04-24', '600487'), ('2017-04-24', '600500'), ('2017-04-24', '000656'), ('2017-04-24', '601899'), ('2017-04-24', '000728'), ('2017-04-24', '600297'), ('2017-04-24', '600601'), ('2017-04-24', '600220'), ('2017-04-24', '002142'), ('2017-04-24', '600037'), ('2017-04-24', '600582'), ('2017-04-24', '300085'), ('2017-04-24', '002007'), ('2017-04-24', '000552'), ('2017-04-24', '603169'), ('2017-04-24', '300124'), ('2017-04-24', '002327'), ('2017-04-24', '600184'), ('2017-04-24', '600088'), ('2017-04-24', '601198'), ('2017-04-24', '601777'), ('2017-04-24', '002310'), ('2017-04-24', '600094'), ('2017-04-24', '601688'), ('2017-04-24', '600158'), ('2017-04-24', '601901'), ('2017-04-24', '600216'), ('2017-04-24', '002190'), ('2017-04-24', '000538'), ('2017-04-24', '600635'), ('2017-04-24', '000158'), ('2017-04-24', '002195'), ('2017-04-24', '600478'), ('2017-04-24', '601689'), ('2017-04-24', '002277'), ('2017-04-24', '000686'), ('2017-04-24', '600351'), ('2017-04-24', '600993'), ('2017-04-24', '601225'), ('2017-04-24', '601668'), ('2017-04-24', '600366'), ('2017-04-24', '600282'), ('2017-04-24', '600572'), ('2017-04-24', '600835'), ('2017-04-24', '600648'), ('2017-04-24', '001979'), ('2017-04-24', '000999'), ('2017-04-24', '002005'), ('2017-04-24', '600415'), ('2017-04-24', '000089'), ('2017-04-24', '600765'), ('2017-04-24', '000338'), ('2017-04-24', '601857'), ('2017-04-24', '600511'), ('2017-04-24', '002551'), ('2017-04-24', '600021'), ('2017-04-24', '600329'), ('2017-04-24', '000400'), ('2017-04-24', '000587'), ('2017-04-24', '600831'), ('2017-04-24', '600160'), ('2017-04-24', '300115'), ('2017-04-24', '600893'), ('2017-04-24', '600690'), ('2017-04-24', '000600'), ('2017-04-24', '601111'), ('2017-04-24', '002415'), ('2017-04-24', '601118'), ('2017-04-24', '000680'), ('2017-04-24', '002572'), ('2017-04-24', '603868'), ('2017-04-24', '600066'), ('2017-04-24', '600518'), ('2017-04-24', '601088'), ('2017-04-24', '002573'), ('2017-04-24', '002407'), ('2017-04-24', '603993'), ('2017-04-24', '000897'), ('2017-04-24', '000930'), ('2017-04-24', '600718'), ('2017-04-24', '002022'), ('2017-04-24', '600372'), ('2017-04-24', '600639'), ('2017-04-24', '002366'), ('2017-04-24', '600018'), ('2017-04-24', '000762'), ('2017-04-24', '600289'), ('2017-04-24', '600112'), ('2017-04-24', '601872'), ('2017-04-24', '600436'), ('2017-04-24', '600743'), ('2017-04-24', '600171'), ('2017-04-24', '002064'), ('2017-04-24', '600031'), ('2017-04-24', '000829'), ('2017-04-24', '600886'), ('2017-04-24', '000566'), ('2017-04-24', '600348'), ('2017-04-24', '000848'), ('2017-04-24', '000008'), ('2017-04-24', '300159'), ('2017-04-24', '000612'), ('2017-04-24', '601168'), ('2017-04-24', '000581'), ('2017-04-24', '002176'), ('2017-04-24', '600981'), ('2017-04-24', '000425'), ('2017-04-24', '600196'), ('2017-04-24', '000926'), ('2017-04-24', '600805'), ('2017-04-24', '600198'), ('2017-04-24', '600161'), ('2017-04-24', '300002'), ('2017-04-24', '601002'), ('2017-04-24', '600537'), ('2017-04-24', '603883'), ('2017-04-24', '600580'), ('2017-04-24', '600332'), ('2017-04-24', '002308'), ('2017-04-24', '600584'), ('2017-04-24', '603188'), ('2017-04-24', '000050'), ('2017-04-24', '600428'), ('2017-04-24', '601633'), ('2017-04-24', '002183'), ('2017-04-24', '000156'), ('2017-04-24', '002588'), ('2017-04-24', '600098'), ('2017-04-24', '600687'), ('2017-04-24', '600826'), ('2017-04-24', '600073'), ('2017-04-24', '600900'), ('2017-04-24', '600120'), ('2017-04-24', '002475'), ('2017-04-24', '600122'), ('2017-04-24', '600460'), ('2017-04-24', '600516'), ('2017-04-24', '000825'), ('2017-04-24', '600959'), ('2017-04-24', '002194'), ('2017-04-24', '600850'), ('2017-04-24', '002019'), ('2017-04-24', '000402'), ('2017-04-24', '002230'), ('2017-04-24', '000718'), ('2017-04-24', '600276'), ('2017-04-24', '600703'), ('2017-04-24', '002657'), ('2017-04-24', '002002'), ('2017-04-24', '600422'), ('2017-04-24', '600111'), ('2017-04-24', '603019'), ('2017-04-24', '600219'), ('2017-04-24', '600790'), ('2017-04-24', '600970'), ('2017-04-24', '601377'), ('2017-04-24', '601099'), ('2017-04-24', '601985'), ('2017-04-24', '300015'), ('2017-04-24', '000895'), ('2017-04-24', '002106'), ('2017-04-24', '600880'), ('2017-04-24', '600783'), ('2017-04-24', '600104'), ('2017-04-24', '601818'), ('2017-04-24', '002332'), ('2017-04-24', '000651'), ('2017-04-24', '600157'), ('2017-04-24', '600416'), ('2017-04-24', '002707'), ('2017-04-24', '002385'), ('2017-04-24', '000783'), ('2017-04-24', '002390'), ('2017-04-24', '600325'), ('2017-04-24', '603025'), ('2017-04-24', '002081'), ('2017-04-24', '300039'), ('2017-04-24', '002244'), ('2017-04-24', '600062'), ('2017-04-24', '002568'), ('2017-04-24', '002424'), ('2017-04-24', '000973'), ('2017-04-24', '600079'), ('2017-04-24', '002029'), ('2017-04-24', '601866'), ('2017-04-24', '600061'), ('2017-04-24', '600737'), ('2017-04-24', '002690'), ('2017-04-24', '002714'), ('2017-04-24', '600699'), ('2017-04-24', '000625'), ('2017-04-24', '002460'), ('2017-04-24', '600570'), ('2017-04-24', '600666'), ('2017-04-24', '600804'), ('2017-04-24', '002405'), ('2017-04-24', '603005'), ('2017-04-24', '601333'), ('2017-04-24', '002251'), ('2017-04-24', '300296'), ('2017-04-24', '002152'), ('2017-04-24', '600352'), ('2017-04-24', '600848'), ('2017-04-24', '000669'), ('2017-04-24', '000685'), ('2017-04-24', '002238'), ('2017-04-24', '600280'), ('2017-04-24', '000061'), ('2017-04-24', '002410'), ('2017-04-24', '603328'), ('2017-04-24', '600267'), ('2017-04-24', '600685'), ('2017-04-24', '002155'), ('2017-04-24', '600967'), ('2017-04-24', '600483'), ('2017-04-24', '002051'), ('2017-04-24', '000513'), ('2017-04-24', '000028'), ('2017-04-24', '002092'), ('2017-04-24', '002266'), ('2017-04-24', '000540'), ('2017-04-24', '300027'), ('2017-04-24', '600376'), ('2017-04-24', '600640'), ('2017-04-24', '002444'), ('2017-04-24', '600208'), ('2017-04-24', '600704'), ('2017-04-24', '600895'), ('2017-04-24', '300202'), ('2017-04-24', '600433'), ('2017-04-24', '600118'), ('2017-04-24', '600917'), ('2017-04-24', '300273'), ('2017-04-24', '600736'), ('2017-04-24', '603885'), ('2017-04-24', '600380'), ('2017-04-24', '601127'), ('2017-04-24', '000413'), ('2017-04-24', '600183'), ('2017-04-24', '000099'), ('2017-04-24', '600435'), ('2017-04-24', '600259'), ('2017-04-24', '002093'), ('2017-04-24', '601186'), ('2017-04-24', '600750'), ('2017-04-24', '601288'), ('2017-04-24', '000157'), ('2017-04-24', '002698'), ('2017-04-24', '000503'), ('2017-04-24', '000761'), ('2017-04-24', '600755'), ('2017-04-24', '601766'), ('2017-04-24', '603698'), ('2017-04-24', '002041'), ('2017-04-24', '601611'), ('2017-04-24', '600298'), ('2017-04-24', '002414'), ('2017-04-24', '000528'), ('2017-04-24', '600009'), ('2017-04-24', '600010'), ('2017-04-24', '600816'), ('2017-04-24', '600177'), ('2017-04-24', '002544'), ('2017-04-24', '600058'), ('2017-04-24', '000750'), ('2017-04-24', '600426'), ('2017-04-24', '000616'), ('2017-04-24', '000877'), ('2017-04-24', '002589'), ('2017-04-24', '600864'), ('2017-04-24', '000661'), ('2017-04-24', '000709'), ('2017-04-24', '002123'), ('2017-04-24', '600637'), ('2017-04-24', '000937'), ('2017-04-24', '600588'), ('2017-04-24', '000012'), ('2017-04-24', '600300'), ('2017-04-24', '601919'), ('2017-04-24', '603866'), ('2017-04-24', '000078'), ('2017-04-24', '000572'), ('2017-04-24', '600038'), ('2017-04-24', '603567'), ('2017-04-24', '002603'), ('2017-04-24', '002050'), ('2017-04-24', '000596'), ('2017-04-24', '600284'), ('2017-04-24', '000630'), ('2017-04-24', '000998'), ('2017-04-24', '002739'), ('2017-04-24', '002174'), ('2017-04-24', '601166'), ('2017-04-24', '002672'), ('2017-04-24', '601601'), ('2017-04-24', '600373'), ('2017-04-24', '002342'), ('2017-04-24', '000938'), ('2017-04-24', '600872'), ('2017-04-24', '300144'), ('2017-04-24', '600153'), ('2017-04-24', '000401'), ('2017-04-24', '600978'), ('2017-04-24', '002358'), ('2017-04-24', '002408'), ('2017-04-24', '002635'), ('2017-04-24', '601678'), ('2017-04-24', '600827'), ('2017-04-24', '600748'), ('2017-04-24', '002261'), ('2017-04-24', '600125'), ('2017-04-24', '600884'), ('2017-04-24', '600468'), ('2017-04-24', '002340'), ('2017-04-24', '600663'), ('2017-04-24', '600811'), ('2017-04-24', '600741'), ('2017-04-24', '600871'), ('2017-04-24', '002311'), ('2017-04-24', '600466'), ('2017-04-24', '600776'), ('2017-04-24', '300253'), ('2017-04-24', '002673'), ('2017-04-24', '600175'), ('2017-04-24', '002250'), ('2017-04-24', '600089'), ('2017-04-24', '002202'), ('2017-04-24', '600596'), ('2017-04-24', '002038'), ('2017-04-24', '601258'), ('2017-04-24', '600594'), ('2017-04-24', '002491'), ('2017-04-24', '300122'), ('2017-04-24', '002146'), ('2017-04-24', '600309'), ('2017-04-24', '002008'), ('2017-04-24', '300024'), ('2017-04-24', '002027'), ('2017-04-24', '600863'), ('2017-04-24', '300133'), ('2017-04-24', '300058'), ('2017-04-24', '002416'), ('2017-04-24', '601336'), ('2017-04-24', '600585'), ('2017-04-24', '600138'), ('2017-04-24', '000062'), ('2017-04-24', '002056'), ('2017-04-24', '000636'), ('2017-04-24', '002241'), ('2017-04-24', '002465'), ('2017-04-24', '600496'), ('2017-04-24', '601939'), ('2017-04-24', '300274'), ('2017-04-24', '600029'), ('2017-04-24', '600022'), ('2017-04-24', '300146'), ('2017-04-24', '601788'), ('2017-04-24', '600881'), ('2017-04-24', '600521'), ('2017-04-24', '600597'), ('2017-04-24', '600030'), ('2017-04-24', '000931'), ('2017-04-24', '600867'), ('2017-04-24', '000066'), ('2017-04-24', '600517'), ('2017-04-24', '600874'), ('2017-04-24', '002268'), ('2017-04-24', '600565'), ('2017-04-24', '600307'), ('2017-04-24', '600557'), ('2017-04-24', '000667'), ('2017-04-24', '002498'), ('2017-04-24', '002640'), ('2017-04-24', '600482'), ('2017-04-24', '300251'), ('2017-04-24', '000623'), ('2017-04-24', '002477'), ('2017-04-24', '601006'), ('2017-04-24', '000415'), ('2017-04-24', '600879'), ('2017-04-24', '000983'), ('2017-04-24', '000001'), ('2017-04-24', '000631'), ('2017-04-24', '300059'), ('2017-04-24', '601021'), ('2017-04-24', '000423'), ('2017-04-24', '601928'), ('2017-04-24', '000166'), ('2017-04-24', '600026'), ('2017-04-24', '002439'), ('2017-04-24', '600614')]
    # stock_file_list = [('2017-04-24', '000627'), ('2017-04-24', '000681'), ('2017-04-24', '002602')]
    batch_access = BatchStockDataAccess(stock_file_list)
    batch_data = batch_access.batch_load_data()
    mem_count = 0
    for key in batch_data.keys():
        temp_data = batch_data[key].memory_usage().sum()
        print("----------" + str(temp_data))
        mem_count = mem_count + temp_data
    print(mem_count)
    # client.save('batch_data', batch_data)
    # new_batch_data = client.load('batch_data')
    # print(new_batch_data.__sizeof__())

